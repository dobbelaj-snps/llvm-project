; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: opt -S -passes=jump-threading < %s | FileCheck %s

; ModuleID = 'reduced.bc'
target datalayout = "e-m:e-p270:32:32-p271:32:32-p272:64:64-i64:64-i128:128-f80:128-n8:16:32:64-S128"
target triple = "x86_64-unknown-linux-gnu"

declare fastcc i1 @test01() local_unnamed_addr

define fastcc i8 @test02(ptr nocapture readonly %0) local_unnamed_addr {
  %2 = load ptr, ptr %0, ptr_provenance ptr null, align 8
  %3 = icmp eq ptr %2, null
  br i1 %3, label %4, label %common.ret

common.ret:                                       ; preds = %4, %1
  ret i8 0

4:                                                ; preds = %1
  %5 = tail call fastcc i1 @test01()
  br label %common.ret
}

define fastcc i1 @test03(ptr nocapture readonly %0) local_unnamed_addr {
  %2 = load ptr, ptr %0, ptr_provenance ptr null, align 8
  %3 = icmp eq ptr %2, null
  br i1 %3, label %4, label %test02.exit

4:                                                ; preds = %1
  %5 = tail call fastcc i1 @test01()
  br label %test02.exit

test02.exit: ; preds = %1, %4
  %6 = call ptr @llvm.noalias.decl.p0.p0.i64(ptr null, i64 0, metadata !0)
  %7 = load ptr, ptr %0, ptr_provenance ptr null, align 8
  %8 = icmp eq ptr %7, null
  br i1 %8, label %common.ret, label %9

common.ret:                                       ; preds = %9, %test02.exit
  ret i1 false

9:                                                ; preds = %test02.exit
  %10 = call ptr @llvm.provenance.noalias.p0.p0.p0.p0.i64(ptr null, ptr %6, ptr null, ptr null, i64 0, metadata !0)
  %11 = load volatile { i1, i8 }, ptr %10, align 1
  br label %common.ret
}

; Function Attrs: mustprogress nocallback nofree nosync nounwind willreturn memory(inaccessiblemem: readwrite)
declare ptr @llvm.noalias.decl.p0.p0.i64(ptr, i64, metadata) #0

; Function Attrs: mustprogress nocallback nofree nosync nounwind speculatable willreturn memory(none)
declare ptr @llvm.provenance.noalias.p0.p0.p0.p0.i64(ptr, ptr, ptr, ptr, i64, metadata) #1

attributes #0 = { mustprogress nocallback nofree nosync nounwind willreturn memory(inaccessiblemem: readwrite) }
attributes #1 = { mustprogress nocallback nofree nosync nounwind speculatable willreturn memory(none) }

!0 = !{!1}
!1 = distinct !{!1, !2, !"dummy: 0"}
!2 = distinct !{!2, !"dummy"}
